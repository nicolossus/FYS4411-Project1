%================================================================
\section{Introduction}\label{sec:Introduction}
%================================================================

Bose-Einstein condensation (BEC), predicted by Einstein \citeyearpar{BEC1924, BEC1925} on the basis of the quantum formulations of Bose \citeyearpar{Bose1924}, is a state of matter in which a large fraction of an ultracold, dilute gas of bosons simultaneously occupy the lowest accessible quantum state. Almost three quarters of a century after its prediction, BEC was observed in experiments with ultracold, dilute alkali gases confined in magnetic or optical traps, notably vapors of $^{87}$Rb \citep{BEC1995}. A Bose gas used to obtain the BEC is a finite-sized and inhomogeneous system, which makes predicting the properties of the system a many-body problem with a nontrivial solution. Fortunately, the dilute nature of the gas means the physics is dominated by two-body collisions and we can describe the effects of the interaction accurately with just a single physical parameter; the s-wave scattering length, $a$ (\cite{Dalfovo1999}). For $^{87}$Rb, the s-wave scattering length $a_\mathrm{Rb} = 100 a_0$, where $a_0 = 0.5292 \, \text{Å}$ is the Bohr radius, is usually chosen. In most cases, the confining traps are well approximated by harmonic potentials, and the trap frequency, $\omega_\mathrm{ho}$, provides a characteristic length of the system $a_\mathrm{ho} \equiv \qty[\hbar / \qty(m \omega_\mathrm{ho})]^{1/2}$. A typical trap for $^{87}$Rb is $a_\mathrm{ho}=1 \mbox{ -- } 2 \cdot 10^4 \, \text{Å}$. For calculations it is thus convenient to use the definite ratio of scattering length to trap length and $a_\mathrm{Rb} / a_\mathrm{ho} = 4.33 \cdot 10^{-3}$ is usually chosen (see e.g. \cite{DuBois2001}). Although the physical interaction can be simply described by the scattering length, we still need the wave function of the system in order to predict its properties. For most problems, the exact wave function is unknown and the crux of a problem resides in the need to define an approximation to the exact wave function. One approach to this problem is to construct a trial wave function which depends on selected variational parameters and captures as much of the physical features of the system as possible. As finding expectation values of quantum mechanical operators involve integrating out $3N$ degrees of freedom, Monte Carlo methods, known for being a particularly attractive choice for multidimensional integrals, become indispensable tools. In particular, the variational Monte Carlo (VMC) method, which is based on the variational principle, consists of finding the values of variational parameters for which the expectation value of the energy is the lowest possible. With these optimal variational parameters, the trial wave function is then an approximation to the ground-state wave function and provides an upper bound of the exact ground-state energy. 

In this project, we build a VMC framework with the aim to find an upper bound of the ground state energy of a system of diluted $^{87}$Rb trapped in either a spherical or elliptical harmonic oscillator. We consider two Markov chain Monte Carlo (MCMC) sampling algorithms; (i) the common random walk Metropolis (RWM) which explores the local neighborhood of the current state of the Markov chain using proposals from a symmetric probability distribution, and (ii) an algorithm based on the the nonlinear diffusion described by the Fokker-Planck and Langevin equations where the proposals are driven according to the gradient flow of the probability density of the trial wave function. The drift introduced in the second algorithm will typically move the Markov chain faster towards the center of the target distribution and thus mix faster than the plain RWM algorithm. We refer to the second algorithm as Langevin Metropolis-Hastings (LMH) due to its resemblance to Langevin Monte-Carlo type algorithms such as the Metropolis-adjusted Langevin algorithm (MALA) \citep{MALA}. In MCMC algorithms, the size of the jumps in the state space of the Markov chain is typically controlled by the scale parameter of the proposal distribution. It is then intuitively clear that we can make an algorithm arbitrarily poor by choosing a scale parameter that is either too small or too large. In our VMC framework, we aim to develop procedures for automatic detection of an optimal scale of the proposal distribution. The optimal set of variational parameter values is the one that minimizes the expectation value of the energy of the system. An exhaustive search over candidate values in order to find the optimal set is generally computationally expensive or even infeasible, which necessitates the need of using optimization algorithms for this endeavor. By ensuring that the energy functional on the trial wave function becomes a convex functional, we may use methods from convex optimization, such as gradient descent, for finding the optimal variational parameters. Gradient descent methods will be incorporated into our VMC framework as well. Moreover, we will also investigate the use of methods for automatic differentiation to negate the need of closed-form expressions for a particular quantum system under examination. 

The project is organized as follows. In \autoref{sec:Theory} we first provide the theoretical background of the VMC method before presenting the system under examination and its associated quantities. Next, the specifics of the methodologies, i.e., the MCMC algorithms, the gradient descent algorithms and so forth, used in our VMC framework are given in \autoref{sec:Method}. The results are presented and discussed in \autoref{sec:Results}, before subsequently they are concluded upon in \autoref{sec:Conclusion}. Lastly, an outline of possible continuations of the present work are provided in \autoref{sec:Future}.


%\textcolor{red}{Updated:}\\
%Bose-Einstein condensation (BEC), predicted by Einstein \citeyearpar{BEC1924, BEC1925} on the basis of the quantum formulations of Bose \citeyearpar{Bose1924}, is a state of matter in which a large fraction of an ultracold (Critical temperature $T_c$ nearing absolute zero at which the gas goes through a phase transition. In this phase every particle falls into the lowest quantum state usually referred to as the ground state.),  low density gas of bosons, that is, particles of integer spin that obey Bose-Einstein statistics, simultaneously occupy the ground state. Thus, the particles can all be described by the same wave function. We can then write the expected value of the energy as
%\begin{align}
%    \left\langle E \right\rangle = \frac{\int d\mathbf{R} %\mathbf{\Psi}_T^*(\mathbf{R},\alpha) H(\mathbf{R}) %\mathbf{\Psi}_T(\mathbf{R},\alpha)}{\int d\mathbf{R} %\mathbf{\Psi}_T^*(\mathbf{R},\alpha)\mathbf{\Psi}_T(\mathbf{R},\alpha)}
%    \label{eq:eev}
%\end{align}

%Here, the vector $\mathbf{R}$ contains the position of all particles and $\alpha$ is the variational parameter. We know that the variational principle states that the expectation value $\left\langle E \right\rangle$⟩ is an upper bound for the ground state energy $E_0$.
%\begin{equation}
%E_0 \leq \left\langle E \right\rangle
%\label{vp}
%\end{equation}

%An example of such a system, which was observed almost three quarters of a century after its prediction, is the BEC system in gases of ultracold, dilute alkali atoms such as \ce{^{7}Li}, \ce{^{23}Na} and \ce{^{87}Rb} confined in magnetic or optical traps, notably vapors of \citeyearpar{BEC1995}. A Bose gas used to obtain the BEC is a finite-sized and inhomogeneous system, which makes predicting the properties of the system a many-body problem with a nontrivial solution. 

%Fortunately, \citeyearpar{Dalfovo1999} states that in practice the dilute nature of the gas allows us to describe the effects of the interaction accurately with just a single physical parameter; the s-wave scattering length, $a$. In most cases, the confining traps are well approximated by harmonic potentials, and the trap frequency, $\omega_{ho}$, provides a characteristic length of the system  $a_\mathrm{ho} = \qty[\hbar / \qty(m \omega_\mathrm{ho})]^{1/2}$. [According to [1], they calculated the characteristic length of a trap for the \ce{^{87}Rb} gas $a_{ho}$. The s-wave scattering length $a_{Rb}$ set to $100$ $a_0$ with $a_0 = 0.5292 \text{ \AA}$ being the Bohr radius. The inner-atomic spacing is $l \simeq 10^4 \text{ \AA}$ and given that the effective size of the atom is small when compared to both the trap size and the inner-atomic spacing, the given system is dilute. This alone tells us that the system is dominated by the two-body collisions between the particles, which is again, represented by the s-wave scattering of length a]

%For most problems, the exact wave function is unknown and the crux of a problem resides in the need to define an approximation to the wave function. One approach to this problem is to construct a trial wave function which depends on selected variational parameters and captures as much of the physical features of the system as possible. We will consider a system of $N$ bosons with mass $m$ which are trapped in a harmonic oscillator potential. Many theoretical studies of BEC in gases of alkali atoms confined in magnetic or optical traps have been conducted in the frame work of the Gross-Pitaevskii (GP) equation [2]. As finding expectation values of quantum mechanical operators involve integrating out $3N$ degrees of freedom, Monte Carlo methods, known for being a particularly attractive choice for multidimensional integrals, become indispensable tools.

%Typically, such large multi-dimensional systems like these ones are very complex and cannot be solved analytically, therefore we will need to turn to numerical approaches in order to make a valueable simulation of the system. To begin with, we will study the non-interacting case where analytical solutions are presented, but fade away when moving to the correlated case which is very convoluted and can only be solved numerically. For our task, we will be using Variational Monte Carlo (VMC) in order to arrive to a good estimate for the expectation of the ground state energy given by equation \ref{eq:eev}. The VMC method is based on the variational principle, shown in equation \ref{vp} which consists of finding the values of variational parameters for which the expectation value of the energy is the lowest possible. With these optimal variational parameters, the trial wave function is then an approximation to the ground-state wave function and provides an upper bound of the exact ground-state energy. For the VMC method, we will compare brute-force and importance sampling which uses the Fokker-Planck equation to take educated guesses as to where the ground state is located, contrary to brute-force VMC. 

% [1]
% \bibitem{DuBois-Glyde01} 
% J.L. Dubois and H. R. Glyde.
% Bose-Einstein condesation in trapped bosons: A variational Monte Carlo analysis.
% \textit{Physical Review A} \textbf{63}, 023602 (Jan 2001)

% [2]
% \bibitem{Fab-Polls99}
%  A. Fabrocini and A. Polls. 
%  Beyond Gross-Pitaevskii:local density vs. correlated basis approach for trapped bosons 
%  \textit{Physical Review A} \textbf{60}, 2319 (Jan 1999) 


